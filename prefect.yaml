# prefect.yaml

# The pull section contains instructions for the worker at runtime.
# This is the most important part for your use case.
pull:
  # Step 1: Clone the Git repository. We give it an ID to reference it later.
  - prefect.deployments.steps.git_clone:
      id: clone-repo
      repository: https://github.com/AloisCRR/repossessed-assets.git
      # You can specify a branch if you want, otherwise it uses the default
      # branch: main

  # Step 2: Install dependencies from requirements.txt.
  # This step runs after the repository has been cloned.
  - prefect.deployments.steps.pip_install_requirements:
      # Use the output from the 'clone-repo' step to specify the directory.
      directory: "{{ clone-repo.directory }}"
      # The name of your requirements file.
      requirements_file: requirements.txt

# The deployments section defines one or more deployments.
deployments:
  - name: github-stats-yaml-deployment
    description: A complex flow that fetches GitHub stats, deployed via YAML.
    tags:
      - etl
      - github
      - tutorial
    
    # This points to your flow file and function.
    # The path is relative to the root of your cloned repository.
    entrypoint: my_complex_flow.py:github_stats_flow

    # You can define default parameters here.
    parameters:
      username: "PrefectHQ"
      
    # This tells the deployment which work pool to use.
    # It MUST match the pool your worker is configured for.
    work_pool:
      name: local-pool